<!doctype html>
<html>
<head>

    <% include head.ejs %>

    <!-- JQuery -->
    <script>
        $(document).ready(function() {
            // Target url should be modified when the service will be sold
            var socket = io.connect("http://localhost:2070");

            $("#btn-commute-all-user").click(function() {
                location.href = location.pathname;
            });

            $("#searched-user-list").delegate('.list-group-item', 'click', function() {
                var title = this.title;
                var titleArray = title.split(" / ");

                var user_name = titleArray[0].trim();
                var user_employee_number = titleArray[1].trim();
                var user_smartphone_address = titleArray[2].trim();

                $("#user-smartphone-address").text(user_smartphone_address).hide();

                var str_info = user_name + "(" + user_employee_number + ")";
                $("#commute-info").html("Click to send new commute data with <strong>" + str_info + "</strong>");
            });

            $("#btn-commute-send").click(function() {
                socket.emit("circumstance", {
                    BeaconDeviceAddress1: '00:1A:7D:DA:71:07',
                    BeaconDeviceAddress2: '00:1A:7D:DA:71:03',
                    BeaconDeviceAddress3: 'B8:27:EB:E1:47:EB',
                    BeaconData1: 'f0f4c176a62342efac3a66f21a11993e00020001',
                    BeaconData2: 'bf0cc4a4eb9f4f06b7161f5ff49a8f4700020002',
                    BeaconData3: '709bd64042d14b1a990a36d4a1e527d800030001',
                    SmartphoneAddress: $("#user-smartphone-address").text()
                });
            });

        });
    </script>

</head>
<body>

<div id="wrapper">

    <!-- Navigation -->
    <div>
        <% include nav.ejs %>
    </div>

    <!-- Content -->
    <div id="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="text-center">
                                <h4>New Commute Data</h4>
                            </div>
                        </div>
                        <div class="panel-body">
                            <form method="post">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label for="sel-department">Department</label>
                                        <select class="form-control" name="sel_department">
                                            <option>All</option>
                                            <%
                                            for (var i = 0; i < departmentList.length; i++) {
                                                var row = departmentList[i];
                                            %>
                                            <option><%=row.department %></option>
                                            <%
                                            }
                                            %>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="sel-position">Position</label>
                                        <select class="form-control" name="sel_position">
                                            <option>All</option>
                                            <%
                                            for (var i = 0; i < positionList.length; i++) {
                                                var row = positionList[i];
                                            %>
                                            <option><%=row.position %></option>
                                            <%
                                            }
                                            %>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label><input type="checkbox" name="check_permission">Permission</label>
                                        </div>
                                        <div class="checkbox">
                                            <label><input type="checkbox" name="check_admin">Admin</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-10" style="padding-right: 5px;">
                                        <div class="text-right">
                                            <input type="button" class="btn btn-sm btn-info" id="btn-commute-all-user" value="ALL">
                                        </div>
                                    </div>
                                    <div class="col-md-2" style="padding-left: 10px;">
                                        <input type="submit" class="btn btn-sm btn-info" id="btn-commute-search" value="SEARCH">
                                    </div>
                                </div>
                            </form>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="list-group pre-scrollable" id="searched-user-list" style="margin-bottom: 0px;">
                                        <%
                                        for (var i = 0; i < userList.length; i++) {
                                            var row = userList[i];
                                        %>
                                        <a href="#" class="list-group-item" title="<%=row.name %> / <%=row.employee_number %> / <%=row.smartphone_address %>"><%=row.name %> / <%=row.employee_number %></a>
                                        <%
                                        }
                                        %>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <div class="col-md-10">
                                    <div id="commute-info">
                                        Select user to send new commute data
                                    </div>
                                    <div id="user-smartphone-address">

                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <input type="button" class="btn btn-primary" id="btn-commute-send" value="SEND">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">Panel Header</div>
                        <div class="panel-body">Panel Content</div>
                        <div class="panel-footer">Panel Footer</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">Panel Header</div>
                        <div class="panel-body">Panel Content</div>
                        <div class="panel-footer">Panel Footer</div>
                    </div>
                </div>
            </div> <!-- End of .row -->
            <div class="row">
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">Panel Header</div>
                        <div class="panel-body">Panel Content</div>
                        <div class="panel-footer">Panel Footer</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">Panel Header</div>
                        <div class="panel-body">Panel Content</div>
                        <div class="panel-footer">Panel Footer</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">Panel Header</div>
                        <div class="panel-body">Panel Content</div>
                        <div class="panel-footer">Panel Footer</div>
                    </div>
                </div>
            </div> <!-- End of .row -->
        </div> <!-- End of .container-fluid -->
    </div> <!-- End of #content -->

</div> <!-- End of #wrapper -->

</body>
</html>