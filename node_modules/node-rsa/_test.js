var NodeRSA = require('./src/NodeRSA');
/*var key = new NodeRSA({ b: 1024 });

console.log(key.keyPair.keySize);
var emLen = Math.floor((key.keyPair.keySize - 1) / 8);
console.log(emLen)
//var emLen = key.getMaxMessageSize()
console.log(key.getKeySize())
var hLen = 32; // OAEP.digestLength['sha256'];
var salt_len = emLen - hLen - 3;
key.setOptions({ signingScheme: { scheme: 'pss', hash: 'sha256', saltLength:  salt_len } });

var toSign = new Buffer("test");
var sig = key.sign(toSign);
console.log("Is signature valid ?", key.verify(toSign, sig));

'use strict';*/

var key = new NodeRSA('-----BEGIN PRIVATE KEY-----\n'+
    'MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALQHEIBxMQF4pGlH\n'+
    'Nf3IOuBZsWeg58ItDsxXFUJk7GMMTmn5aEL7aAvLM1d1TQzQAR61IJTfxIWm6VCM\n'+
    '9w2JYkHn9/p5llbDbAJ7XAlcYCtKUBWITnzbwhnAWAPkHb2LY60A96US2VlUuECe\n'+
    'nyMY0ooJi+g7XnGohdNY2jj2OJPNAgMBAAECgYAFv7oBArGtby7/kP9s43GEi5Nf\n'+
    'kKMGBOQAQNb+yp6ainXl6snaZbviBd2rBnsXlHw3VlJm3qnLGNRCNxYxRPixvgLk\n'+
    'bomCkNvCR13NJM1CPX+OyBRJH/FG6dMawEwtwHqZeA8n3fW0mx1L0v2sIg07OJtj\n'+
    '2GgCYzgYBBsGXG5eMQJBAMaxNcPkAlRAbs1PP+Y5vl0IY75jghiU/xwqDRqLySy2\n'+
    'tg5yiImCR1myWDSeFu2PsXVA8kV7y+szzQbI2QYy8EUCQQDn87f0wsUB1eoGJyVq\n'+
    'MeC8DLiprYIQSr56wDtR981Zo0mEDDmyOkaUq/fAM23bTKOiLuTHXAliQPkGM+Tj\n'+
    'ByHpAkEAoL/yfb/U2pEek+CQFBWXm/ETsY8UTAsPspua6mU5p4FTHbEwIgBS9ZDC\n'+
    'qB9W8XAV5IVc/TZBLtNEBz8rxkYj+QJBALC36+BsAALdApa7fnMBG1LKcmq8Ccr1\n'+
    '11fYW5mgrXBsypbzZYXXhmzA9FoYFMuvAUCQb7c/9NpJ3DCQmwMpLPkCQDK+ln+Q\n'+
    'A41Jz/vRtfM7v4U0ojA8uBrnTuol+Y7PecVcQWicNRA34uPS18JT3rBTJQoLfS3y\n'+
    'MOKv/gBu3QiWMe8=\n'+
    '-----END PRIVATE KEY-----');

var text = 'PNqenCzfKQwImb153wrVgEBbmOKQQSmUnQX98m0uTgg18bWHT/4djGuIo1roZVo8UjfdAGRjPsgjXbGVuhS8mWjm9v+uGPXySEG381fads+rRv/a5b2hMSeIXm3TDFGAe37nDcIkuFHVix5pcxgK9z78aMaKjEdf7U+Yf7QpNbg=';


var encrypted = key.encrypt(text);
console.log('Decrypt with Private');
var decrypted = key.decrypt(encrypted);
console.log('decrypted: ', decrypted);